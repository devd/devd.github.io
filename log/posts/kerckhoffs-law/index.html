<!DOCTYPE html><html domain="devd.me" ga-id="UA-5474337-3" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self';object-src 'none';script-src 'self' 'sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=';style-src 'unsafe-inline';img-src 'self' data:" http-equiv="Content-Security-Policy"><link href="/img/favicon/favicon-192x192.png?hash=2089033c93" rel="icon" type="image/png"><meta content="#f9c412" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Kerckhoff‚Äôs Law for Security Engineers</title><meta content="Kerckhoff‚Äôs Law for Security Engineers" property="og:title"><meta content="What can we learn from Kerckhoff's law for all security engineering" name="description"><meta content="What can we learn from Kerckhoff's law for all security engineering" property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@frgx" name="twitter:site"><meta content="@frgx" name="twitter:creator"><link href="https://devd.me/log//posts/kerckhoffs-law/" rel="canonical"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/log/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Dev's log"><link href="/" rel="preconnect" crossorigin=""><script async="" defer="" src="/js/min.js?hash=c372ec6a84" data-cwv-src="/js/web-vitals.js?hash=4a3c7b61e1"></script><script async="" defer="" src="/js/cached.js?hash=9030142fbb"></script><script csp-hash="sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #f9c412;--primary-dark: #e7bf60;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{position:fixed;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog{background-color:#8dff80;position:fixed;opacity:.9;z-index:1000}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress,header nav{z-index:1;width:100vw;left:0;top:0}#reading-progress{background-color:var(--primary);position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:normal;font-named-instance:"Regular";src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:italic;font-named-instance:"Italic";src:url(/fonts/Inter-italic.var.woff2) format("woff2")}html{line-height:1.15;-webkit-text-size-adjust:100%;font-family:Inter UI,sans-serif;--font-family: Inter UI, sans-serif}body,p,ul{font-size:1em}body{margin:0}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem;line-height:2.4rem;margin-bottom:1.36rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}strong{font-weight:700}header,img{margin:0 auto;max-width:100%}img{border-style:none;height:auto}p,ul{margin-bottom:1.5em}body,p,ul{font-size:1rem;line-height:1.6}p,ul{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}body,p,ul{font-size:1.1rem;line-height:1.6}h1,p,ul{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}body,p,ul{font-size:1.2rem;line-height:1.6}h1,p,ul{margin-bottom:1.632rem}}mark{background:#f9c412;padding:0 .3em;background:var(--primary)}a:hover{text-decoration:underline}dt{font-weight:600;padding-top:.75em;padding-left:.75em}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif;--font-family: Inter UI var alt, sans-serif}}*{border:0;box-sizing:border-box}body,h1,header nav a{font-family:var(--font-family)}body{background:#181818;color:#eee}header{padding:4.5em 1.5em 3em;width:37.5em;text-align:center;display:flex;align-items:center;flex-direction:column}header p,ul{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:rgba(0,0,0,.8);color:#fff;padding:3em;text-align:center}footer>*{margin:1.5em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}</style></head><body><header><nav><div id="nav"><h1><a href="/log/" title="Homepage">Dev's log</a></h1><a href="/log/about/">About</a></div><div id="reading-progress" aria-hidden="true"></div></nav><h1>Kerckhoff‚Äôs Law for Security Engineers</h1><aside>4 min read.</aside><dialog id="message"></dialog><noscript><img alt="" height=1 src="/.netlify/functions/ga?v=1&_v=j83&t=pageview&dr=https%3A%2F%2Fno-script.com&_s=1&dh=devd.me&dp=%2Fposts%2Fkerckhoffs-law%2F&ul=en-us&de=UTF-8&dt=Kerckhoff%E2%80%99s%20Law%20for%20Security%20Engineers&tid=UA-5474337-3" style=display:none width=1></noscript></header><main><article><p>One of the first lessons in cryptography 101 is <a href="https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle">Kerckhoff‚Äôs law</a>: a cryptosystem should be secure even if everything about the system, except the key, is public knowledge. This is an often-repeated maxim accompanied with ‚Äúthere is no security with obscurity.‚Äù</p><p>I always found this framing confusing: it felt inconsistent within itself. ‚Äú<em>don‚Äôt rely on secrecy except for the secrecy of the key</em>‚Äù What is so special about keys? Why is it ok to rely on the secrecy of keys and not on secrecy of anything else? And because it is so focused on keys, it‚Äôs hard to really take this foundational lesson and apply it in contexts other than cryptographic algorithms.</p><p>In <a href="https://www.theatlantic.com/magazine/archive/2002/09/homeland-insecurity/302575/">Schneier‚Äôs framing</a>, the aim here is <em>resilience</em>. Secrecy is a source of brittleness. When something you relied on being secret inevitably leaks, it can be the cause of catastrophic failure. I.e., if you rely on your cryptographic algorithm remaining secret, one day it‚Äôs not and suddenly you are in a world of pain.</p><p>This provides a framing of Kerckhoff‚Äôs law that I have found very useful: the security of your system should <em><strong>rely only on secrecy of things you can change easily</strong></em>. Just using open, well-known algorithms for encryption is not enough. You need to be able to change the key easily.</p><p>Usually, this means <em>supporting</em> key rotation in the design‚Äîe.g., a encryption scheme that integrates with your key management service also includes the key version in the ciphertext. But, in my experience, a stated design goal to support rotation rarely works. Actually rotating the key regularly is the only way to be sure that you can change the key easily. Ideally, your key management service will automatically rotate secrets at a cadence.</p><p>This is then an easy pattern to look for in security design or review: a cryptosystem where the key is static or not rotated regularly is a source of brittleness almost as bad as having a secret algorithm. Unfortunately, the common framing of Kerckhoff‚Äôs law has meant every engineer will detect and flag the use of an obscure, homebrew crypto algorithm but will happily stamp an encryption scheme that never rotates the key (or worse, <em>can‚Äôt</em> rotate the key).</p><p>The reframing also provides a useful lesson for security engineering: relying on secret you are not rotating regularly is a security risk. As much as possible, rely on short-lived secrets and minimize long-lived secrets. For example, for AWS access, do not rely on IAM access keys and secrets; prefer the short-lived credentials provided by role assumption. Ask your vendors to integrate with you using role assumption rather than IAM access keys (something <a href="https://aws.amazon.com/blogs/apn/securely-accessing-customer-aws-accounts-with-cross-account-iam-roles/">even Amazon pushes for</a>).</p><p>I find this philosophy also useful organizationally! A security team unwilling to talk about the architecture or design with customers or researchers is an anti-pattern: the security architecture of an application is not something you can change easily, so sharing it and getting more eyes on it can only help you make secure! Openness and transparency is the mark of a leading security organization. For example, see the Uber security team‚Äôs <a href="https://eng.uber.com/bug-bounty-map/">open treasure map</a>. Or, see the Gitlab security team‚Äôs goal of being the <a href="https://about.gitlab.com/handbook/engineering/security/">most open security team in the world</a>. Or, just the <a href="https://www.chromium.org/Home/chromium-security">Chrome Security team‚Äôs approach</a> overall.</p><p>Finally, it‚Äôs useful to remember the real goal here is robust security. Agility is the only way to achieve true robustness, as we learn of new vulnerabilities in systems and algorithms. Just openness in and of itself does not magically make things secure. Rather, openness is a bet that something has had more eyes on it. But even the most reviewed systems fail over time. TLS1.0, RC4, MD5, CBC, RSA ‚Äî some of the most heavily reviewed systems have been broken over time and the ones we use today will likely be broken some day (hopefully, far) in the future. Can your system adapt?</p><p><em>Thanks to <a href="https://tldrsec.com/">Clint Gibler</a>, Hongyi Hu, Matthew Finifter, Max Burkhardt, Patrick Toomey, Russ Allbery for their feedback. All mistakes are mine and I would love your feedback!</em></p>---<p>üôèüôèüôè</p><p>Since you've made it this far, sharing this article on your favorite social media network would be highly appreciated üíñ! For feedback, please <a href="https://twitter.com/frgx" rel="noopener" target="_blank">ping me on Twitter.</a></p><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Kerckhoff‚Äôs Law for Security Engineers",
  "image": [],
  "author": "Devdatta Akhawe", 
  "genre": "Article", 
  "publisher": {
    "@type": "Organization",
    "name": "Devdatta Akhawe",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/favicon/favicon-192x192.png?hash=2089033c93"
    }
  },
  "url": "https://devd.me/log//posts/kerckhoffs-law/",
  "mainEntityOfPage": "https://devd.me/log//posts/kerckhoffs-law/",
  "datePublished": "2021-06-04",
  "dateModified": "2021-06-04",
  "description": "One of the first lessons in cryptography 101 is Kerckhoff‚Äôs law: a cryptosystem should be secure even if everything about the system, except..."
}</script><p>Published <time datetime="2021-06-04">04 Jun 2021</time></p></article></main><footer><a href="/log/about/">Devdatta Akhawe</a></footer></body></html>